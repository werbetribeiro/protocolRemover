<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <title>Removedor de Protocolos</title>
</head>

<body class="bg-light">

    <div class="p-4 bg-secondary"></div>

    <div class="container">
        <h2 class="text-center m-5">Removedor de Protocolos</h2>

        <small>
            <ol class="mb-4">
                <li><strong>Observação 01:</strong> Esse método serve para remover os protocolos vindo de todo local,
                    bastando ter a sequência "Protocolo XXXXXX";
                </li>
                <li>Copie os protocolos, como era feito com as planilhas do excel;</li>
                <li>Cole os protocolos no local indicado;</li>
                <li><strong>Observação 02:</strong> Ao clicar no botão, os prototoclos já são copiados para área de
                    transferência, bastando apenas colar no local desejado.
                </li>
            </ol>
        </small>

        <textarea class=" form-control" id="texto" style="resize: none;" rows="7"
            placeholder="Cole aqui o texto para remoção dos protocolos"></textarea>

        <button onclick="extrairProtocolos()" class="btn btn-primary mt-4 btn-mb">Remover Protocolos</button>

        <h4 class="m-5 text-center">Números de Protocolos</h4>

        <div class="container">
            <ol id="protocolos" class="list-group list-group-numbered">
            </ol>
        </div>
    </div>


    <script>
        function extrairProtocolos() {
            var texto = document.getElementById("texto").value;
            var regex = /Protocolo\s+(\d+)/g;
            var protocolosExtraidos = [];
            var match;

            while ((match = regex.exec(texto)) !== null) {
                protocolosExtraidos.push(match[1]);
            }

            var lista = document.getElementById("protocolos");
            lista.innerHTML = '';

            var lista = document.getElementById("protocolos");
            lista.removeChild
            var listado = ""

            for (var i = 0; i < protocolosExtraidos.length; i++) {
                lista.insertAdjacentHTML("afterbegin", `<li class="list-group-item list-group-item-action d-flex align-items-center"> &nbsp ${protocolosExtraidos[i]} <input class="form-check-input ms-4" type="checkbox"> </li>`)
                listado += protocolosExtraidos[i] + "\n"
            }


            const copyBtn = event.srcElement;

            copyBtn.textContent = 'Protocolos Copiados';
            copyBtn.classList.remove('btn-primary');
            copyBtn.classList.add('btn-success');

            setTimeout(function () {
                copyBtn.textContent = 'Remover Protocolos';
                copyBtn.classList.remove('btn-success');
                copyBtn.classList.add('btn-primary');
            }, 4500);

            navigator.clipboard.writeText(listado)
                .then(function () {
                    console.log("Protocolos copiados para a área de transferência!")
                })
                .catch(function (error) {
                    alert("Erro ao Copiar + error")
                })

            document.getElementById("texto").value = "";
        }
    </script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
        crossorigin="anonymous"></script>

</body>

</html>